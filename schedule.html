<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Jadwal Rilis</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
    <div class="logo">SCHEDULE</div>
</header>

<div style="overflow-x:auto; white-space:nowrap; padding:10px; background:#1e1e1e;" id="dayTabs">
    </div>

<div id="scheduleGrid" class="grid">
    </div>

<nav class="bottom-nav">
    <a href="index.html" class="nav-item">Home</a>
    <a href="schedule.html" class="nav-item active">Jadwal</a>
    <a href="history.html" class="nav-item">History</a>
</nav>

<script>
    const API_BASE = "https://anichin-seven.vercel.app/api";

    async function getSchedule() {
        try {
            const res = await fetch(`${API_BASE}/schedule`);
            const data = await res.json();
            const schedule = data.schedule; // Array of objects { day: "Senin", donghua_list: [] }

            // Render Tabs Hari
            const tabsContainer = document.getElementById('dayTabs');
            tabsContainer.innerHTML = schedule.map((day, index) => `
                <button onclick="showDay(${index})" style="background:none; border:none; color:white; padding:10px; cursor:pointer; font-weight:bold;">
                    ${day.day}
                </button>
            `).join('');

            // Simpan data di window object biar bisa diakses fungsi showDay
            window.scheduleData = schedule;
            
            // Show hari pertama default
            showDay(0);

        } catch (e) { console.error(e); }
    }

    function showDay(index) {
        const data = window.scheduleData[index];
        const grid = document.getElementById('scheduleGrid');
        
        grid.innerHTML = data.donghua_list.map(anime => `
            <div class="card" onclick="window.location.href='stream.html?url=${anime.href}'">
                <img src="${anime.poster}" loading="lazy">
                <p>${anime.title}</p>
                <div style="position:absolute; top:0; right:0; background:var(--primary); font-size:0.7rem; padding:2px 5px;">Ep ${anime.episode}</div>
            </div>
        `).join('');
    }

    getSchedule();
</script>
</body>
</html>
